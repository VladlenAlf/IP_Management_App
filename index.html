<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Zarządzania Podsieciami</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="header-left">
                    <h1>System Zarządzania Podsieciami</h1>
                </div>
                <div class="header-right">
                    <span class="user-info" id="userInfo">Ładowanie...</span>
                    <button class="btn btn-secondary btn-small" onclick="logout()">Wyloguj</button>
                </div>
            </div>
            <div class="stats" id="stats">
                <div class="stat-item">
                    <span class="stat-number" id="totalSubnets">0</span>
                    <span class="stat-label">Łącznie podsieci</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number occupied" id="assignedSubnets">0</span>
                    <span class="stat-label">Przypisane</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number free" id="freeSubnets">0</span>
                    <span class="stat-label">Wolne</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="totalCompanies">0</span>
                    <span class="stat-label">Firmy</span>
                </div>
            </div>
        </header>

        <nav class="tabs">
            <button class="tab-button active" onclick="showTab('subnet-management')">Podsieci</button>
            <button class="tab-button" onclick="showTab('company-management')">Firmy</button>
            <button class="tab-button" onclick="showTab('import-export')">Import/Eksport</button>
            <button class="tab-button" onclick="showTab('analytics')">Analityka</button>
            <button class="tab-button" onclick="showTab('subnet-history')">Historia podsieci</button>
            <button class="tab-button" onclick="showTab('ip-calculator')">Kalkulator IP</button>
            <button class="tab-button" onclick="showTab('audit-logs')">Logi systemu</button>
        </nav>

        <!-- Subnet Management Tab -->
        <div id="subnet-management" class="tab-content active">
            <div class="toolbar">
                <button class="btn btn-primary" onclick="showAddSubnetModal()">Dodaj podsieć</button>
                <button class="btn btn-success" onclick="showDivideSubnetModal()">Podziel podsieć (wybierz z listy)</button>
                <button class="btn btn-success" onclick="showMergeSubnetsModal()">Połącz podsieci</button>
                <button class="btn btn-danger" onclick="showAssignFreeSubnetsModal()">Przypisz wolne podsieci</button>
                
                <div class="filters">
                    <input type="text" id="searchInput" placeholder="Szukaj podsieci lub wprowadź adres IP..." onkeyup="filterSubnets()">
                    <input type="text" id="vlanFilter" placeholder="Filtruj według VLAN..." onkeyup="filterSubnets()">
                    <input type="text" id="companyTextFilter" placeholder="Szukaj firmy..." onkeyup="filterSubnets()">
                    <button class="btn btn-secondary btn-small" onclick="clearSubnetFilters()">Wyczyść filtry</button>
                </div>
            </div>

            <div class="table-container">
                <table id="subnetTable">
                    <thead>
                        <tr>
                            <th><input type="checkbox" id="selectAllSubnets" onchange="toggleAllSubnets()"></th>
                            <th>Sieć</th>
                            <th>Maska</th>
                            <th>Dostępne IP</th>
                            <th>Firma</th>
                            <th>VLAN</th>
                            <th>Opis</th>
                            <th>Utworzono</th>
                            <th>Akcje</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Company Management Tab -->
        <div id="company-management" class="tab-content">
            <div class="toolbar">
                <button class="btn btn-primary" onclick="showAddCompanyModal()">Dodaj firmę</button>
            </div>

            <div class="table-container">
                <table id="companyTable">
                    <thead>
                        <tr>
                            <th>Nazwa</th>
                            <th>Opis</th>
                            <th>Liczba podsieci</th>
                            <th>Utworzono</th>
                            <th>Akcje</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Import/Export Tab -->
        <div id="import-export" class="tab-content">
            <div class="import-section">
                <h3>Import podsieci z Excel</h3>
                <div class="file-upload">
                    <input type="file" id="excelFile" accept=".xlsx,.xls" onchange="handleFileSelect()">
                    <button class="btn btn-primary" onclick="importExcel()">Importuj podsieci</button>
                </div>
                <div class="import-info">
                    <p>Obsługiwane kolumny: network, mask, company_id, vlan, description, name</p>
                    <p>Przykład: 192.168.1.0, 24, 1, 100, Sieć biurowa, WSPA</p>
                    <p><strong>Uwaga:</strong> Jeśli podasz 'name', firma zostanie utworzona automatycznie i przypisana do podsieci z tym company_id</p>
                </div>
                
                <h3>Eksport do Excel</h3>
                <div class="export-buttons">
                    <button class="btn btn-success" onclick="exportExcel()">Pobierz dane (Excel)</button>
                    <p class="export-info">Eksportowane kolumny: network, mask, company_id, vlan, description, name</p>
                </div>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div id="analytics" class="tab-content">
            <div class="toolbar">
                <div class="analytics-filters">
                    <select id="analyticsCompanyFilter" onchange="updateAnalytics()">
                        <option value="">Wszystkie firmy</option>
                    </select>
                    
                    <input type="date" id="analyticsDateFrom" onchange="updateAnalytics()">
                    <span>do</span>
                    <input type="date" id="analyticsDateTo" onchange="updateAnalytics()">
                    
                    <button class="btn btn-secondary" onclick="resetAnalyticsFilters()">Resetuj filtry</button>
                    <button class="btn btn-primary" onclick="updateAnalytics()">Odśwież</button>
                </div>
            </div>

            <div class="analytics-grid">
                <!-- Main Stats Cards -->
                <div class="analytics-card">
                    <h3>Statystyki podsieci</h3>
                    <div class="stats-mini">
                        <div class="stat-mini">
                            <span class="stat-value" id="analyticsTotal">0</span>
                            <span class="stat-label">Łącznie podsieci</span>
                        </div>
                        <div class="stat-mini">
                            <span class="stat-value assigned" id="analyticsAssigned">0</span>
                            <span class="stat-label">Przypisane</span>
                        </div>
                        <div class="stat-mini">
                            <span class="stat-value free" id="analyticsFree">0</span>
                            <span class="stat-label">Wolne</span>
                        </div>
                        <div class="stat-mini">
                            <span class="stat-value" id="analyticsCompanies">0</span>
                            <span class="stat-label">Firmy</span>
                        </div>
                    </div>
                </div>

                <!-- Subnets Usage Pie Chart -->
                <div class="analytics-card">
                    <h3>Wykorzystanie podsieci</h3>
                    <canvas id="subnetsUsageChart"></canvas>
                </div>

                <!-- Companies Bar Chart -->
                <div class="analytics-card">
                    <h3>Podsieci według firm</h3>
                    <canvas id="companiesChart"></canvas>
                </div>

                <!-- VLAN Distribution Chart -->
                <div class="analytics-card">
                    <h3>Rozkład VLAN</h3>
                    <canvas id="vlanChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Audit Logs Tab -->
        <div id="audit-logs" class="tab-content">
            <div class="toolbar">
                <div class="filters">
                    <select id="actionFilter" onchange="filterLogs()">
                        <option value="">Wszystkie akcje</option>
                        <option value="LOGIN_SUCCESS">Logowanie</option>
                        <option value="LOGIN_FAILED">Nieudane logowanie</option>
                        <option value="LOGOUT">Wylogowanie</option>
                        <option value="CREATE_SUBNET">Tworzenie podsieci</option>
                        <option value="UPDATE_SUBNET">Modyfikacja podsieci</option>
                        <option value="DELETE_SUBNET">Usuwanie podsieci</option>
                        <option value="DIVIDE_SUBNET">Podział podsieci</option>
                        <option value="MERGE_SUBNETS">Łączenie podsieci</option>
                        <option value="ASSIGN_FREE_SUBNETS">Przypisanie wolnych podsieci</option>
                        <option value="CREATE_COMPANY">Tworzenie firmy</option>
                        <option value="UPDATE_COMPANY">Modyfikacja firmy</option>
                        <option value="DELETE_COMPANY">Usuwanie firmy</option>
                        <option value="IMPORT_EXCEL">Import z Excel</option>
                        <option value="EXPORT_EXCEL">Eksport do Excel</option>
                    </select>
                    
                    <select id="entityFilter" onchange="filterLogs()">
                        <option value="">Wszystkie obiekty</option>
                        <option value="user">Użytkownicy</option>
                        <option value="subnet">Podsieci</option>
                        <option value="company">Firmy</option>
                    </select>
                    
                    <input type="text" id="userFilter" placeholder="Użytkownik..." onkeyup="filterLogs()">
                    
                    <input type="date" id="dateFromFilter" onchange="filterLogs()">
                    <input type="date" id="dateToFilter" onchange="filterLogs()">
                    
                    <button class="btn btn-secondary" onclick="refreshLogs()">Odśwież</button>
                    <button class="btn btn-secondary" onclick="clearLogsFilters()">Wyczyść filtry</button>
                </div>
            </div>

            <div class="table-container">
                <table id="logsTable">
                    <thead>
                        <tr>
                            <th>Data/Czas</th>
                            <th>Użytkownik</th>
                            <th>Akcja</th>
                            <th>Obiekt</th>
                            <th>ID</th>
                            <th>Szczegóły</th>
                            <th>Adres IP</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            
            <div class="pagination" id="logsPagination"></div>
        </div>

        <!-- IP Calculator Tab -->
        <div id="ip-calculator" class="tab-content">
            <h3>Kalkulator IP</h3>
            <p>Narzędzie do obliczania parametrów sieci IP. Wprowadź adres IP i maskę sieci, aby uzyskać szczegółowe informacje o sieci.</p>
            
            <div class="calculator-container">
                <div class="calculator-input">
                    <h4>Wprowadź dane sieci</h4>
                    
                    <div class="form-group">
                        <label for="calcIpAddress">Adres IP *</label>
                        <input type="text" id="calcIpAddress" placeholder="192.168.1.100" maxlength="15">
                        <small class="help-text">Wprowadź dowolny adres IP z sieci (np. 192.168.1.100)</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="calcSubnetMask">Maska sieci *</label>
                        <select id="calcSubnetMask">
                            <option value="">Wybierz maskę...</option>
                            <option value="8">/8 (255.0.0.0)</option>
                            <option value="9">/9 (255.128.0.0)</option>
                            <option value="10">/10 (255.192.0.0)</option>
                            <option value="11">/11 (255.224.0.0)</option>
                            <option value="12">/12 (255.240.0.0)</option>
                            <option value="13">/13 (255.248.0.0)</option>
                            <option value="14">/14 (255.252.0.0)</option>
                            <option value="15">/15 (255.254.0.0)</option>
                            <option value="16">/16 (255.255.0.0)</option>
                            <option value="17">/17 (255.255.128.0)</option>
                            <option value="18">/18 (255.255.192.0)</option>
                            <option value="19">/19 (255.255.224.0)</option>
                            <option value="20">/20 (255.255.240.0)</option>
                            <option value="21">/21 (255.255.248.0)</option>
                            <option value="22">/22 (255.255.252.0)</option>
                            <option value="23">/23 (255.255.254.0)</option>
                            <option value="24">/24 (255.255.255.0)</option>
                            <option value="25">/25 (255.255.255.128)</option>
                            <option value="26">/26 (255.255.255.192)</option>
                            <option value="27">/27 (255.255.255.224)</option>
                            <option value="28">/28 (255.255.255.240)</option>
                            <option value="29">/29 (255.255.255.248)</option>
                            <option value="30">/30 (255.255.255.252)</option>
                            <option value="31">/31 (255.255.255.254)</option>
                            <option value="32">/32 (255.255.255.255)</option>
                        </select>
                        <small class="help-text">lub</small>
                        <input type="text" id="calcSubnetMaskCustom" placeholder="255.255.255.0" maxlength="15">
                        <small class="help-text">Wprowadź maskę w notacji CIDR (z listy) lub dziesiętnej (pole tekstowe)</small>
                    </div>
                    
                    <div class="form-group">
                        <button type="button" class="btn btn-primary" onclick="calculateNetwork()">Oblicz parametry sieci</button>
                        <button type="button" class="btn btn-secondary" onclick="clearCalculator()">Wyczyść</button>
                    </div>
                    
                    <div id="calculatorError" class="error-message" style="display: none;"></div>
                </div>
                
                <div class="calculator-results" id="calculatorResults" style="display: none;">
                    <h4>Wyniki obliczeń</h4>
                    
                    <div class="result-grid">
                        <div class="result-item">
                            <label>Adres sieci:</label>
                            <span id="resultNetwork" class="result-value"></span>
                        </div>
                        
                        <div class="result-item">
                            <label>Maska sieci:</label>
                            <span id="resultSubnetMask" class="result-value"></span>
                        </div>
                        
                        <div class="result-item">
                            <label>Notacja CIDR:</label>
                            <span id="resultCidr" class="result-value"></span>
                        </div>
                        
                        <div class="result-item">
                            <label>Adres rozgłoszeniowy:</label>
                            <span id="resultBroadcast" class="result-value"></span>
                        </div>
                        
                        <div class="result-item">
                            <label>Pierwszy adres hosta:</label>
                            <span id="resultHostMin" class="result-value"></span>
                        </div>
                        
                        <div class="result-item">
                            <label>Ostatni adres hosta:</label>
                            <span id="resultHostMax" class="result-value"></span>
                        </div>
                        
                        <div class="result-item">
                            <label>Liczba hostów:</label>
                            <span id="resultHosts" class="result-value"></span>
                        </div>
                        
                        <div class="result-item">
                            <label>Dostępne adresy:</label>
                            <span id="resultUsableHosts" class="result-value"></span>
                        </div>
                        
                        <div class="result-item">
                            <label>Klasa sieci:</label>
                            <span id="resultNetworkClass" class="result-value"></span>
                        </div>
                        
                        <div class="result-item">
                            <label>Typ sieci:</label>
                            <span id="resultNetworkType" class="result-value"></span>
                        </div>
                    </div>
                    
                    <div class="result-info">
                        <h5>Informacje dodatkowe</h5>
                        <div id="resultAdditionalInfo"></div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Modal for adding subnet -->
    <div id="subnetModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('subnetModal')">&times;</span>
            <h2 id="subnetModalTitle">Dodaj podsieć</h2>
            <form id="subnetForm">
                <input type="hidden" id="subnetId">
                
                <div class="form-group">
                    <label for="subnetNetwork">Sieć *</label>
                    <input type="text" id="subnetNetwork" placeholder="192.168.1.0" required>
                </div>
                
                <div class="form-group">
                    <label for="subnetMask">Maska *</label>
                    <select id="subnetMask" required>
                        <option value="1">/1 - 2B adresów</option>
                        <option value="2">/2 - 1B adresów</option>
                        <option value="3">/3 - 536M adresów</option>
                        <option value="4">/4 - 268M adresów</option>
                        <option value="5">/5 - 134M adresów</option>
                        <option value="6">/6 - 67M adresów</option>
                        <option value="7">/7 - 33M adresów</option>
                        <option value="8">/8 (255.0.0.0) - 16M adresów</option>
                        <option value="9">/9 - 8M adresów</option>
                        <option value="10">/10 - 4M adresów</option>
                        <option value="11">/11 - 2M adresów</option>
                        <option value="12">/12 (255.240.0.0) - 1M adresów</option>
                        <option value="13">/13 - 524K adresów</option>
                        <option value="14">/14 - 262K adresów</option>
                        <option value="15">/15 - 131K adresów</option>
                        <option value="16">/16 (255.255.0.0) - 65K adresów</option>
                        <option value="17">/17 - 32K adresów</option>
                        <option value="18">/18 - 16K adresów</option>
                        <option value="19">/19 - 8K adresów</option>
                        <option value="20">/20 (255.255.240.0) - 4K adresów</option>
                        <option value="21">/21 - 2K adresów</option>
                        <option value="22">/22 - 1K adresów</option>
                        <option value="23">/23 - 510 adresów</option>
                        <option value="24">/24 (255.255.255.0) - 254 adresy</option>
                        <option value="25">/25 (255.255.255.128) - 126 adresów</option>
                        <option value="26">/26 (255.255.255.192) - 62 adresy</option>
                        <option value="27">/27 (255.255.255.224) - 30 adresów</option>
                        <option value="28">/28 (255.255.255.240) - 14 adresów</option>
                        <option value="29">/29 (255.255.255.248) - 6 adresów</option>
                        <option value="30">/30 (255.255.255.252) - 2 adresy</option>
                        <option value="31">/31 - Point-to-point link</option>
                        <option value="32">/32 - Host route</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="subnetCompany">Firma</label>
                    <select id="subnetCompany">
                        <option value="">Wolna (nieprzypisana)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="subnetVlan">VLAN</label>
                    <input type="number" id="subnetVlan" min="1" max="4094" placeholder="np. 100">
                </div>
                
                <div class="form-group">
                    <label for="subnetDescription">Opis</label>
                    <textarea id="subnetDescription" rows="3"></textarea>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Zapisz</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('subnetModal')">Anuluj</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for log details -->
    <div id="logDetailsModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <span class="close" onclick="closeModal('logDetailsModal')">&times;</span>
            <h2>Szczegóły loga audytu</h2>
            <div id="logDetailsContent">
                <div class="log-detail-section">
                    <h3>Podstawowe informacje</h3>
                    <div class="log-detail-grid">
                        <div class="log-detail-item">
                            <strong>Data i czas:</strong>
                            <span id="logDetailDate"></span>
                        </div>
                        <div class="log-detail-item">
                            <strong>Użytkownik:</strong>
                            <span id="logDetailUser"></span>
                        </div>
                        <div class="log-detail-item">
                            <strong>Akcja:</strong>
                            <span id="logDetailAction"></span>
                        </div>
                        <div class="log-detail-item">
                            <strong>Typ obiektu:</strong>
                            <span id="logDetailEntity"></span>
                        </div>
                        <div class="log-detail-item">
                            <strong>ID obiektu:</strong>
                            <span id="logDetailEntityId"></span>
                        </div>
                        <div class="log-detail-item">
                            <strong>Adres IP:</strong>
                            <span id="logDetailIp"></span>
                        </div>
                    </div>
                </div>
                
                <div class="log-detail-section" id="oldValuesSection" style="display: none;">
                    <h3>Stare wartości</h3>
                    <pre id="logDetailOldValues" class="log-values"></pre>
                </div>
                
                <div class="log-detail-section" id="newValuesSection" style="display: none;">
                    <h3>Nowe wartości</h3>
                    <pre id="logDetailNewValues" class="log-values"></pre>
                </div>
                
                <div class="log-detail-section">
                    <h3>Informacje techniczne</h3>
                    <div class="log-detail-item">
                        <strong>User Agent:</strong>
                        <span id="logDetailUserAgent" style="word-break: break-all;"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for adding/editing company -->
    <div id="companyModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('companyModal')">&times;</span>
            <h2 id="companyModalTitle">Dodaj firmę</h2>
            <form id="companyForm">
                <input type="hidden" id="companyId" value="">
                <div class="form-group">
                    <label for="companyName">Nazwa firmy *</label>
                    <input type="text" id="companyName" required>
                </div>
                <div class="form-group">
                    <label for="companyDescription">Opis</label>
                    <textarea id="companyDescription"></textarea>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Zapisz</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('companyModal')">Anuluj</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for dividing subnet -->
    <div id="divideSubnetModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('divideSubnetModal')">&times;</span>
            <h2>Podziel podsieć</h2>
            <form id="divideSubnetForm">
                <div class="form-group">
                    <label for="divideSubnetSelect">Wybierz podsieć do podziału</label>
                    <select id="divideSubnetSelect" required>
                        <option value="">Wybierz podsieć</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="newMask">Nowa maska podsieci</label>
                    <input type="number" id="newMask" min="1" max="30" required>
                    <small>Maska musi być większa niż aktualna</small>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Podziel</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('divideSubnetModal')">Anuluj</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for merging subnets -->
    <div id="mergeSubnetsModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('mergeSubnetsModal')">&times;</span>
            <h2>Połącz podsieci</h2>
            <form id="mergeSubnetsForm">
                <div class="form-group">
                    <label>Wybrane podsieci do połączenia:</label>
                    <div id="selectedSubnetsForMerge"></div>
                    <small>Zaznacz podsieci w tabeli używając checkboxów</small>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Połącz</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('mergeSubnetsModal')">Anuluj</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for assigning free subnets -->
    <div id="assignFreeSubnetsModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('assignFreeSubnetsModal')">&times;</span>
            <h2>Przypisz wolne podsieci</h2>
            <form id="assignFreeSubnetsForm">
                <div class="form-group">
                    <label for="assignToCompany">Przypisz wszystkie wolne podsieci do firmy</label>
                    <select id="assignToCompany" required>
                        <option value="">Wybierz firmę</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Przypisz</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('assignFreeSubnetsModal')">Anuluj</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Subnet History Tab -->
    <div id="subnet-history" class="tab-content">
        <h3>Historia podsieci</h3>
        <p>Pełna historia wszystkich podsieci w systemie - aktywnych i usuniętych.</p>
        
        <div class="toolbar">
            <div class="filters">
                <input type="text" id="historySubnetFilter" placeholder="Szukaj podsieci..." onkeyup="filterSubnetHistory()">
                <select id="historyStatusFilter" onchange="filterSubnetHistory()">
                    <option value="">Wszystkie statusy</option>
                    <option value="active">Aktywne</option>
                    <option value="deleted">Usunięte</option>
                </select>
                <select id="historyCompanyFilter" onchange="filterSubnetHistory()">
                    <option value="">Wszystkie firmy</option>
                </select>
                <button class="btn btn-secondary" onclick="resetSubnetHistoryFilters()">Wyczyść filtry</button>
            </div>
            <div class="export-buttons">
                <button class="btn btn-success" onclick="exportSubnetHistory()">Eksportuj historię</button>
            </div>
        </div>

        <div class="table-container">
            <table id="subnetHistoryTable">
                <thead>
                    <tr>
                        <th>Adres sieci</th>
                        <th>Maska</th>
                        <th>Firma</th>
                        <th>VLAN</th>
                        <th>Status</th>
                        <th>Data utworzenia</th>
                        <th>Data usunięcia</th>
                        <th>Ostatnia aktywność</th>
                        <th>Akcje</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        
        <div class="pagination" id="historyPagination"></div>
    </div>

    <!-- Modal for subnet detailed history -->
    <div id="subnetDetailedHistoryModal" class="modal">
        <div class="modal-content" style="max-width: 1000px;">
            <span class="close" onclick="closeModal('subnetDetailedHistoryModal')">&times;</span>
            <h2 id="subnetHistoryModalTitle">Historia podsieci</h2>
            
            <div class="subnet-info-card">
                <h4>Informacje o podsieci</h4>
                <div id="subnetHistoryInfo"></div>
            </div>
            
            <div class="history-filters">
                <h4>Filtry historii</h4>
                <div class="filters">
                    <select id="detailedHistoryActionFilter" onchange="filterDetailedHistory()">
                        <option value="">Wszystkie akcje</option>
                        <option value="CREATE_SUBNET">Utworzenie</option>
                        <option value="UPDATE_SUBNET">Aktualizacja</option>
                        <option value="DELETE_SUBNET">Usunięcie</option>
                        <option value="DIVIDE_SUBNET">Podział</option>
                        <option value="MERGE_SUBNETS">Połączenie</option>
                        <option value="ASSIGN_SUBNETS">Przypisanie firmy</option>
                    </select>
                    <input type="date" id="detailedHistoryDateFrom" onchange="filterDetailedHistory()" placeholder="Data od">
                    <input type="date" id="detailedHistoryDateTo" onchange="filterDetailedHistory()" placeholder="Data do">
                    <button class="btn btn-secondary" onclick="resetDetailedHistoryFilters()">Wyczyść filtry</button>
                </div>
            </div>
            
            <div class="table-container">
                <table id="detailedHistoryTable">
                    <thead>
                        <tr>
                            <th>Data i czas</th>
                            <th>Użytkownik</th>
                            <th>Akcja</th>
                            <th>Szczegóły</th>
                            <th>Stare wartości</th>
                            <th>Nowe wartości</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            
            <div class="modal-actions">
                <button class="btn btn-success" onclick="exportSubnetDetailedHistory()">Eksportuj historię</button>
                <button class="btn btn-secondary" onclick="closeModal('subnetDetailedHistoryModal')">Zamknij</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="app.js"></script>
</body>
</html>